{% load static %}
{% static 'images/default-avatar.svg' as default_avatar %}
{% with preview_url=profile.avatar_url|default:default_avatar %}
<div class="avatar-upload" aria-live="polite">
  <figure class="avatar-figure">
    <img class="profile-avatar" data-avatar-preview="true" src="{{ preview_url }}" alt="{{ profile.full_name|default:user.get_full_name|default:user.username }} avatar" width="96" height="96" loading="lazy">
    <figcaption class="visually-hidden">Current profile avatar</figcaption>
  </figure>
  {% if can_edit %}
  <div class="avatar-actions">
    <label class="form-label" for="{{ form.avatar.id_for_label }}">Profile photo</label>
    {{ form.avatar }}
    <p class="form-text mb-0">{{ form.avatar.help_text }}</p>
    {% if form.avatar.errors %}
    <div class="invalid-feedback d-block">
      {% for error in form.avatar.errors %}
        <div>{{ error }}</div>
      {% endfor %}
    </div>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endwith %}
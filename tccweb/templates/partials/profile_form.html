{% load static %}
<section class="profile-section" id="edit-profile" aria-labelledby="profile-details-heading">
  <div class="profile-card">
    {% if can_edit %}
      <form id="edit-profile-form" class="profile-form" method="post" action="" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        <fieldset>
          <legend id="profile-details-heading" class="profile-section-title">Profile details</legend>
          <div class="profile-form-intro">
            <p class="text-muted small mb-0">Keep your contact information current so we can reach you when support teams need to follow up.</p>
          </div>
          {% include "partials/avatar_upload.html" %}
          <div class="form-grid" role="group" aria-labelledby="profile-details-heading">
            <div class="form-field">
              <label class="form-label" for="id_full_name">Full name</label>
              <input class="form-control" type="text" name="full_name" id="id_full_name" value="{{ profile.full_name|default:user.get_full_name|default:user.username }}" autocomplete="name">
            </div>
            <div class="form-field">
              <label class="form-label" for="id_email">Email</label>
              <input class="form-control" type="email" name="email" id="id_email" value="{{ profile.email|default:user.email }}" autocomplete="email" required>
            </div>
            <div class="form-field">
              <label class="form-label" for="id_phone">Phone</label>
              <input class="form-control" type="tel" name="phone" id="id_phone" value="{{ profile.phone|default:'' }}" autocomplete="tel">
            </div>
            <div class="form-field">
              <label class="form-label" for="id_location">Location</label>
              <input class="form-control" type="text" name="location" id="id_location" value="{{ profile.location|default:'' }}" autocomplete="address-level2">
            </div>
            <div class="form-field">
              <label class="form-label" for="id_timezone">Timezone</label>
              <input class="form-control" type="text" name="timezone" id="id_timezone" value="{{ profile.timezone|default:'' }}" placeholder="e.g., America/New_York">
            </div>
          </div>
          <div class="form-field">
            <label class="form-label" for="id_bio">Bio</label>
            <textarea class="form-control" name="bio" id="id_bio" rows="4" maxlength="800" aria-describedby="bio-hint">{{ profile.bio|default:'' }}</textarea>
            <div id="bio-hint" class="form-text">Share any information that helps our team support you. Avoid including sensitive data.</div>
          </div>
        </fieldset>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Save changes</button>
          <button type="reset" class="btn btn-outline-secondary">Reset</button>
        </div>
      </form>
    {% else %}
      <div class="profile-summary" aria-live="polite">
        <h2 id="profile-details-heading" class="profile-section-title">Profile details</h2>
        <div class="profile-summary-grid">
          <dl>
            <dt>Full name</dt>
            <dd>{{ profile.full_name|default:user.get_full_name|default:user.username }}</dd>
          </dl>
          <dl>
            <dt>Email</dt>
            <dd><a href="mailto:{{ profile.email|default:user.email }}">{{ profile.email|default:user.email }}</a></dd>
          </dl>
          <dl>
            <dt>Phone</dt>
            <dd>{% if profile.phone %}<a href="tel:{{ profile.phone }}">{{ profile.phone }}</a>{% else %}<span class="text-muted">Not provided</span>{% endif %}</dd>
          </dl>
          <dl>
            <dt>Location</dt>
            <dd>{{ profile.location|default:'Not specified' }}</dd>
          </dl>
          <dl>
            <dt>Timezone</dt>
            <dd>{{ profile.timezone|default:'Not specified' }}</dd>
          </dl>
        </div>
        <div class="profile-summary-bio">
          <h3 class="h6">About</h3>
          <p>{{ profile.bio|default:'No bio available yet.' }}</p>
        </div>
      </div>
    {% endif %}
  </div>
</section>